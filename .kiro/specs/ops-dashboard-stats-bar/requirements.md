# OpsDashboard 数据统计栏功能需求

## 1. 功能概述

在运营数据看板（OpsDashboard.vue）的折线图下方，新增一个极简数据统计栏，用于展示关键流量指标的统计摘要信息。

## 2. 用户故事

**作为** 运营人员  
**我想要** 在折线图下方快速查看流量峰值和日均访问量  
**以便于** 无需分析完整趋势图就能了解核心流量指标

## 3. 验收标准

### 3.1 布局与位置
- [ ] 统计栏位于折线图（`.chart-main`）下方
- [ ] 统计栏高度固定为 100px
- [ ] 统计栏与折线图之间有 20px 的间距（通过 grid gap 实现）
- [ ] 统计栏占据右侧列的完整宽度（与折线图对齐）

### 3.2 数据展示
- [ ] 显示"本月流量峰值 (Peak)"指标
  - 显示最大 PV 值
  - 显示峰值出现的日期
- [ ] 显示"日均访问量 (Avg)"指标
  - 显示平均 PV 值
  - 显示单位"/ 天"

### 3.3 视觉设计
- [ ] 两个指标模块平分统计栏宽度（各占 50%）
- [ ] 使用 Linear 风格的图标：
  - Peak 指标：使用 `Top` 图标，橙红色主题（#E85D3D）
  - Avg 指标：使用 `DataLine` 图标，蓝色主题（#2563EB）
- [ ] 图标容器尺寸：42x42px，圆角 10px
- [ ] 背景色：`#F8FAFC`（浅灰色，与项目主题一致）
- [ ] 边框：`1px solid rgba(0,0,0,0.04)`（极淡边框）
- [ ] 无阴影效果（`box-shadow: none`）

### 3.4 数据计算逻辑
- [ ] 从 `pvuvTrendData` 中提取 PV 系列数据
- [ ] 计算最大 PV 值（`maxPV`）
- [ ] 找到最大 PV 对应的日期（`maxPVDate`）
- [ ] 计算平均 PV 值（`avgPV`）
- [ ] 使用现有的 `formatNumber` 函数格式化数值

### 3.5 响应式行为
- [ ] 当日期范围变化时，统计数据自动更新
- [ ] 当数据加载中时，显示合理的占位状态
- [ ] 在移动端（<1024px）时，统计栏保持可读性

## 4. 技术约束

### 4.1 组件依赖
- 使用 Element Plus 图标组件：`Top`、`DataLine`
- 复用现有的 `formatNumber` 工具函数

### 4.2 样式规范
- 使用 Scoped CSS
- 遵循项目现有的设计变量（`@/assets/styles/variables.scss`）
- 保持与现有卡片样式的一致性

### 4.3 性能要求
- 数据计算应在 `computed` 或 `watch` 中完成，避免重复计算
- 不影响现有图表的渲染性能

## 5. 非功能性需求

### 5.1 可维护性
- 代码注释清晰，说明计算逻辑
- 变量命名语义化（如 `maxPV`、`avgPV`、`maxPVDate`）

### 5.2 可扩展性
- 预留未来添加更多统计指标的可能性
- 统计栏结构应易于调整和扩展

### 5.3 用户体验
- 数值格式化应与页面其他指标保持一致
- 视觉风格应融入现有的"反主流设计"理念

## 6. 设计参考

### 6.1 布局结构
```
┌─────────────────────────────────────────┐
│  左侧区域（指标卡 + 热力图）              │
│                                         │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│  右侧区域（折线图）                      │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │  PV/UV 流量趋势图                 │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │  [图标] 本月流量峰值 | [图标] 日均 │  │
│  │  12.5万 于 10-15   |  8.3万 / 天  │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

### 6.2 颜色规范
- Peak 图标背景：`rgba(232, 93, 61, 0.08)`
- Peak 图标颜色：`#E85D3D`
- Avg 图标背景：`rgba(37, 99, 235, 0.08)`
- Avg 图标颜色：`#2563EB`
- 标签文字：`#94A3B8`（slate-400）
- 数值文字：`#1E293B`（slate-900）
- 辅助文字：`#CBD5E1`（slate-300）

## 7. 验收测试场景

### 7.1 基本功能测试
1. 打开 OpsDashboard 页面
2. 验证统计栏显示在折线图下方
3. 验证显示正确的峰值和平均值
4. 验证日期格式正确（如"10-15"）

### 7.2 数据更新测试
1. 切换日期范围（如选择"国庆黄金周"）
2. 验证统计数据随之更新
3. 验证数值格式化正确（如"12.5万"）

### 7.3 边界情况测试
1. 数据为空时的显示状态
2. 极大数值的格式化（如超过亿级）
3. 单日数据的平均值计算

## 8. 优先级

**高优先级** - 这是一个快速提升数据可读性的功能，能够显著改善用户体验。

## 9. 预估工作量

- 数据计算逻辑：30 分钟
- UI 实现与样式调整：45 分钟
- 测试与调优：15 分钟
- **总计**：约 1.5 小时

## 10. 相关文档

- 现有文档：`docs/OpsDashboard-标题更新说明-v4.6.md`
- 现有文档：`docs/OpsDashboard-图标升级说明-v4.5.md`
- 现有文档：`docs/OpsDashboard-布局比例调整说明-v4.4.md`
